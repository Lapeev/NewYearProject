!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){var i=r(1);"string"==typeof i&&(i=[[e.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};r(3)(i,n);i.locals&&(e.exports=i.locals)},function(e,t,r){},,function(e,t,r){var i,n,s={},o=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===n&&(n=i.apply(this,arguments)),n}),a=function(e){var t={};return function(e,r){if("function"==typeof e)return e();if(void 0===t[e]){var i=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,r);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}}(),c=null,u=0,f=[],l=r(4);function p(e,t){for(var r=0;r<e.length;r++){var i=e[r],n=s[i.id];if(n){n.refs++;for(var o=0;o<n.parts.length;o++)n.parts[o](i.parts[o]);for(;o<i.parts.length;o++)n.parts.push(g(i.parts[o],t))}else{var a=[];for(o=0;o<i.parts.length;o++)a.push(g(i.parts[o],t));s[i.id]={id:i.id,refs:1,parts:a}}}}function d(e,t){for(var r=[],i={},n=0;n<e.length;n++){var s=e[n],o=t.base?s[0]+t.base:s[0],a={css:s[1],media:s[2],sourceMap:s[3]};i[o]?i[o].parts.push(a):r.push(i[o]={id:o,parts:[a]})}return r}function h(e,t){var r=a(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=f[f.length-1];if("top"===e.insertAt)i?i.nextSibling?r.insertBefore(t,i.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),f.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var n=a(e.insertAt.before,r);r.insertBefore(t,n)}}function v(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=f.indexOf(e);t>=0&&f.splice(t,1)}function m(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var i=function(){0;return r.nc}();i&&(e.attrs.nonce=i)}return _(t,e.attrs),h(e,t),t}function _(e,t){Object.keys(t).forEach(function(r){e.setAttribute(r,t[r])})}function g(e,t){var r,i,n,s;if(t.transform&&e.css){if(!(s="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=s}if(t.singleton){var o=u++;r=c||(c=m(t)),i=y.bind(null,r,o,!1),n=y.bind(null,r,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",_(t,e.attrs),h(e,t),t}(t),i=function(e,t,r){var i=r.css,n=r.sourceMap,s=void 0===t.convertToAbsoluteUrls&&n;(t.convertToAbsoluteUrls||s)&&(i=l(i));n&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var o=new Blob([i],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(o),a&&URL.revokeObjectURL(a)}.bind(null,r,t),n=function(){v(r),r.href&&URL.revokeObjectURL(r.href)}):(r=m(t),i=function(e,t){var r=t.css,i=t.media;i&&e.setAttribute("media",i);if(e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}.bind(null,r),n=function(){v(r)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else n()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=o()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=d(e,t);return p(r,t),function(e){for(var i=[],n=0;n<r.length;n++){var o=r[n];(a=s[o.id]).refs--,i.push(a)}e&&p(d(e,t),t);for(n=0;n<i.length;n++){var a;if(0===(a=i[n]).refs){for(var c=0;c<a.parts.length;c++)a.parts[c]();delete s[a.id]}}}};var w,b=(w=[],function(e,t){return w[e]=t,w.filter(Boolean).join("\n")});function y(e,t,r,i){var n=r?"":i.css;if(e.styleSheet)e.styleSheet.cssText=b(t,n);else{var s=document.createTextNode(n),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(s,o[t]):e.appendChild(s)}}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,i=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var n,s=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(s)?e:(n=0===s.indexOf("//")?s:0===s.indexOf("/")?r+s:i+s.replace(/^\.\//,""),"url("+JSON.stringify(n)+")")})}},function(e,t,r){"use strict";r.r(t);r(0);var i=function(e){if(e)return{isActive:"localStorage"in e}}(window);function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._view=t,this.page,this.input}var t,r,s;return t=e,(r=[{key:"showModal",value:function(e){var t=e.target;if("IMG"===t.nodeName)this._view.refs.popupImg.src=t.getAttribute("data-full"),this._view.refs.popupImg.dataset.small=t.src,this._view.refs.baseGallery.classList.contains("d-none")?this._view.refs.addFavorite.classList.add("popup__button_star-active"):this.tellingIfInStorage(),this._view.refs.popup.classList.remove("d-none"),this._view.refs.body.style.overflowY="hidden";else if("BUTTON"===t.nodeName){if(i.isActive&&null!==localStorage.getItem("doms")&&""!==localStorage.getItem("doms")){var r=t.parentNode.firstElementChild.outerHTML,n=localStorage.getItem("doms").split(",");localStorage.setItem("doms","".concat(n.filter(function(e){return e!==r})))}t.parentNode.outerHTML=""}}},{key:"fetchFunction",value:function(){var e=this;if(""!==this._view.refs.input.value||this.page>=1){null==this.page?this.page=1:this.page,this.input=""!==this._view.refs.input.value?this._view.refs.input.value:this.input;var t={key:"11172718-f6e56b8a08a6b762793b5fef6",q:this.input,lang:"ru",image_type:"photo",per_page:12,page:this.page};fetch("https://pixabay.com/api/?key=".concat(t.key,"&q=").concat(t.q,"&lang=").concat(t.lang,"&image_type=").concat(t.image_type,"&page=").concat(t.page,"&per_page=").concat(t.per_page)).then(function(e){if(200==e.status)return e.json();throw new Error("Error while fetching: ".concat(e.statusText))}).then(function(r){e.page++,e._view.createDOM(r,t)}),this._view.refs.input.value=""}}},{key:"tellingIfInStorage",value:function(){if(i.isActive&&null!==localStorage.getItem("doms")&&""!==localStorage.getItem("doms")){var e=localStorage.getItem("doms");this._view.refs.addFavorite.classList.contains("popup__button_star-active")&&this._view.refs.addFavorite.classList.remove("popup__button_star-active"),-1!==e.indexOf(this._view.refs.popupImg.src)&&this._view.refs.addFavorite.classList.add("popup__button_star-active")}}}])&&n(t.prototype,r),s&&n(t,s),e}();function o(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.refs={},this.refs.gallery=document.querySelector(".main__gallery_base"),this.refs.galleryFavorite=document.querySelector(".main__gallery_favorite"),this.refs.popup=document.querySelector(".main__popup"),this.refs.closePopup=document.querySelector(".popup__button_close"),this.refs.popupImg=document.querySelector(".popup__img"),this.refs.favorite=document.querySelector(".header__favourite"),this.refs.baseGallery=document.querySelector(".main__section_base"),this.refs.favoriteGallery=document.querySelector(".main__section_favorite"),this.refs.modalBack=document.querySelector(".popup__button_back"),this.refs.modalNext=document.querySelector(".popup__button_next"),this.refs.input=document.querySelector(".search__input"),this.refs.more=document.querySelector(".main__more"),this.refs.addFavorite=document.querySelector(".popup__button_star"),this.refs.search=document.querySelector(".search"),this.refs.find=document.querySelector(".search__button"),this.refs.body=document.querySelector("body"),this.refs.modal=document.querySelector(".popup__blur")}var t,r,n;return t=e,(r=[{key:"closeModal",value:function(e){(e.target.classList.contains("popup__blur")||e.target.classList.contains("popup__button_close"))&&(this.refs.popup.classList.add("d-none"),this.refs.popupImg.src="",this.refs.body.style.overflowY="initial")}},{key:"createDOM",value:function(e,t){var r,i=[];e.hits.forEach(function(e){var r=document.createElement("li");r.classList.add("main__item");var n=document.createElement("img");n.classList.add("main__img"),n.classList.add("main__img_main"),r.append(n),n.src="".concat(e.previewURL),n.dataset.full=e.largeImageURL,n.dataset.category=t.q,e.previewHeight<=e.previewWidth?n.classList.add("horisontal"):n.classList.add("vertical"),i.push(r)}),(r=this.refs.gallery).append.apply(r,i),this.refs.more.classList.contains("hiden")&&this.refs.more.classList.remove("hiden")}},{key:"addingFavorite",value:function(){var e=this;if(this.refs.favoriteGallery.classList.contains("d-none")&&i.isActive){var t=Array.from(document.querySelectorAll(".main__img_main")).find(function(t){return t.src==e.refs.popupImg.getAttribute("data-small")}).cloneNode(!1);t.classList.remove("main__img_main"),t.classList.add("main__img_favorite"),null!=localStorage.getItem("doms")&&""!=localStorage.getItem("doms")||(localStorage.setItem("doms","".concat(t.outerHTML)),this.refs.addFavorite.classList.add("popup__button_star-active")),localStorage.getItem("doms").includes("".concat(t.outerHTML))||(localStorage.setItem("doms","".concat(localStorage.getItem("doms"),",").concat(t.outerHTML)),this.refs.addFavorite.classList.add("popup__button_star-active"))}}}])&&o(t.prototype,r),n&&o(t,n),e}();function c(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._view=t,this._model=r,this._view.refs.gallery.addEventListener("click",this._model.showModal.bind(this._model)),this._view.refs.closePopup.addEventListener("click",this._view.closeModal.bind(this._view)),this._view.refs.modal.addEventListener("click",this._view.closeModal.bind(this._view)),this._view.refs.favorite.addEventListener("click",this.showFavorite.bind(this)),this._view.refs.modalBack.addEventListener("click",this.previouse.bind(this)),this._view.refs.modalNext.addEventListener("click",this.next.bind(this)),this._view.refs.find.addEventListener("click",this.showFindInput.bind(this)),this._view.refs.more.addEventListener("click",this.showFind.bind(this)),this._view.refs.addFavorite.addEventListener("click",this._view.addingFavorite.bind(this._view)),document.addEventListener("keypress",this.showFindEnter.bind(this))}var t,r,n;return t=e,(r=[{key:"showFavorite",value:function(){if(this._view.refs.favoriteGallery.classList.toggle("d-none"),this._view.refs.baseGallery.classList.toggle("d-none"),this._view.refs.search.classList.toggle("d-none"),this._view.refs.galleryFavorite.addEventListener("click",this._model.showModal.bind(this)),i.isActive&&null!==localStorage.getItem("doms")&&""!==localStorage.getItem("doms")){var e=localStorage.getItem("doms").split(",").map(function(e){return'<li class="main__item main__item_favorite">'.concat(e,'<button class="favorite__button">&#10006;</button></li>')});this._view.refs.galleryFavorite.innerHTML=e.reverse().join("")}}},{key:"showFind",value:function(e){e.preventDefault(),this._view.refs.gallery.hasAttribute("data-category")?this._view.refs.gallery.hasAttribute("data-category")&&""!==this._view.refs.input.value?(this._view.refs.gallery.dataset.category=this._view.refs.input.value,this._view.refs.gallery.innerHTML="",this.page=1,this._model.fetchFunction()):this._model.fetchFunction():(this._view.refs.gallery.dataset.category=this._view.refs.input.value,this._model.fetchFunction())}},{key:"showFindEnter",value:function(e){13===e.keyCode&&this.showFind(e)}},{key:"showFindInput",value:function(e){""!==this._view.refs.input.value&&this.showFind(e)}},{key:"previouse",value:function(){if(this._view.refs.baseGallery.classList.contains("d-none")){var e=Array.from(document.querySelectorAll(".main__img_favorite")),t=e.map(function(e){return e.src}).indexOf(this._view.refs.popupImg.getAttribute("data-small"));0===t?(this._view.refs.popupImg.src=e[e.length-1].getAttribute("data-full"),this._view.refs.popupImg.dataset.small=e[e.length-1].src):(this._view.refs.popupImg.src=e[t-1].getAttribute("data-full"),this._view.refs.popupImg.dataset.small=e[t-1].src)}else{var r=Array.from(document.querySelectorAll(".main__img_main")),i=r.map(function(e){return e.src}).indexOf(this._view.refs.popupImg.getAttribute("data-small"));0===i?(this._view.refs.popupImg.src=r[r.length-1].getAttribute("data-full"),this._view.refs.popupImg.dataset.small=r[r.length-1].src,this._model.tellingIfInStorage()):(this._view.refs.popupImg.src=r[i-1].getAttribute("data-full"),this._view.refs.popupImg.dataset.small=r[i-1].src,this._model.tellingIfInStorage())}}},{key:"next",value:function(){if(this._view.refs.baseGallery.classList.contains("d-none")){var e=Array.from(document.querySelectorAll(".main__img_favorite")),t=e.map(function(e){return e.src}).indexOf(this._view.refs.popupImg.getAttribute("data-small"));t===e.length-1?(this._view.refs.popupImg.src=e[0].getAttribute("data-full"),this._view.refs.popupImg.dataset.small=e[0].src):(this._view.refs.popupImg.src=e[t+1].getAttribute("data-full"),this._view.refs.popupImg.dataset.small=e[t+1].src)}else{var r=Array.from(document.querySelectorAll(".main__img_main")),i=r.map(function(e){return e.src}).indexOf(this._view.refs.popupImg.getAttribute("data-small"));i===r.length-1?(this._view.refs.popupImg.src=r[0].getAttribute("data-full"),this._view.refs.popupImg.dataset.small=r[0].src,this._model.tellingIfInStorage()):(this._view.refs.popupImg.src=r[i+1].getAttribute("data-full"),this._view.refs.popupImg.dataset.small=r[i+1].src,this._model.tellingIfInStorage())}}}])&&c(t.prototype,r),n&&c(t,n),e}(),f=new a;new u(f,new s(f))}]);
//# sourceMappingURL=index.js.map